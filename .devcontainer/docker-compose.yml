version: "3"
services:
  redis:
    image: redis:latest
    ports:
      - "6379:6379"
    volumes:
      - redis:/data
    networks:
      - ranklab
  ranklab-web:
    build:
      context: ../
      dockerfile: .devcontainer/Dockerfile
    volumes:
      - ..:/workspace:cached
      - /tmp/.X11-unix:/tmp/.X11-unix
    networks:
      ranklab:
        aliases:
          - ranklab-test
    extra_hosts:
      ranklab-test: 0.0.0.0
    environment:
      - NODE_OPTIONS=--max_old_space_size=4096
      - DISPLAY
    depends_on:
      - redis
  xray-daemon:
    image: amazon/aws-xray-daemon
    ports:
      - "2000:2000/udp"
    networks:
      - ranklab
    environment:
      - AWS_REGION=eu-west-2
      - AWS_ACCESS_KEY_ID=AKIA6F52566XD2PPP3CX
      - AWS_SECRET_ACCESS_KEY=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
volumes:
  redis:
networks:
  ranklab:
    name: ranklab
