#!/bin/bash

set -e

rootdir=$(dirname "$(readlink -f "$0")")/..

cd $rootdir
mkdir -p ./tmp/ranklab-api

openapi-generator-cli generate \
  -i http://ranklab-api:8000/openapi.json \
  -o ./tmp/ranklab-api \
  -g typescript-fetch \
  -c ./openapi.config.json

mkdir -p ./packages/ranklab-api
cp ./tmp/ranklab-api/{index.ts,api.ts,configuration.ts,custom.d.ts} ./packages/ranklab-api
yarn workspace @ranklab/api build
